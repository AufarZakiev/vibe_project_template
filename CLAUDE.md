# Инструкции для Claude Code

Прочитай и следуй правилам из `AGENTS.md` — это основной документ с универсальными правилами проекта.

---

## Общие правила окружения

- Для C++ кода в Windows не пытайся запускать сборку

## Секреты

- Никогда не читай файлы `.env`, `.env.local`, `.env.*.local`

---

## Читаемость прежде всего

Код пишется для людей. Читаемость и поддерживаемость всегда важнее хитрых трюков или микрооптимизаций. Производительность важна только когда явно запрошена или при доказанных узких местах.

### Основные принципы

- **Читаемо, а не хитро** — никого не волнуют микросекунды, сэкономленные за счёт нечитаемого кода
- **Явно, а не неявно** — намерение должно быть очевидным, даже если это более многословно
- **Консистентно, а не "правильно"** — следуй существующим паттернам в кодовой базе

### Предпочтения пользователя

- Функциональный стиль где возможно (чистые функции, иммутабельность, избегать сайд-эффектов)
- Конвенции языка (snake_case для Python, camelCase для JS/TS и т.д.)
- Конфиг-объекты вместо множества аргументов одного типа

### Именование и структура

- **Говорящие имена** — никаких однобуквенных переменных, кроме индексов циклов (`i`, `j`)
- **Глагол-существительное для функций** — `getUserData()`, `calculate_total()`, а не `data()` или `process()`
- **Булевы имена как вопросы** — `is_valid`, `hasPermission`, `canEdit`

### Поток управления

- **Ранние возвраты** — уменьшай вложенность с помощью guard clauses
- **Маленькие функции** — если нужна прокрутка, разбей на части
- **Избегай глубокой вложенности** — максимум 2-3 уровня; выделяй вспомогательные функции
- **Switch/match вместо else-if цепочек** — при 3+ ветках по одному значению используй switch/match

```python
# BAD: Глубокая вложенность
def process(data):
    if data:
        if data.is_valid:
            if data.user:
                return data.user.name

# GOOD: Guard clauses
def process(data):
    if not data:
        return None
    if not data.is_valid:
        return None
    if not data.user:
        return None
    return data.user.name
```

### Константы и магические значения

- **Никаких магических чисел/строк** — используй именованные константы
- **Группируй связанные константы** — enum, frozen dataclass, или const-объекты

```typescript
// BAD
if (status === 3) { ... }

// GOOD
const Status = { PENDING: 1, ACTIVE: 2, COMPLETED: 3 } as const;
if (status === Status.COMPLETED) { ... }
```

### Комментарии

- **Объясняй "почему", а не "что"** — код показывает что; комментарии объясняют намерение
- **Удаляй закомментированный код** — для этого есть система контроля версий
- **Обновляй комментарии вместе с кодом** — устаревшие комментарии хуже, чем их отсутствие
- **Не добавляй комментарии, если код уже дублирует их содержание** — не нужно читать одно и то же дважды

### Исключения из этих правил

Пользователь явно укажет, когда:
- Производительность критична (горячие пути, real-time системы)
- Есть ограничения по памяти (embedded, большие наборы данных)
- Требуется конкретная алгоритмическая эффективность

---

## Язык ответов

- Если пользователь пишет на английском — отвечай на английском
- Если пользователь пишет на русском — отвечай на русском

## Обратная связь по английскому языку

Когда пользователь отправляет сообщение на английском, кратко проверь его на:

1. **Грамматические ошибки** — неправильное время, артикли, предлоги, порядок слов. Игнорируй орфографию и пунктуацию
2. **Многословность** — фразы, которые можно сократить без потери смысла
3. **Ясность** — нечёткие или двусмысленные формулировки

### Как давать обратную связь

- В начале ответа добавь короткий раздел "Language tip", если есть что улучшить
- Ограничься 1-3 замечаниями максимум
- Покажи более ясный вариант
- Поддерживай, а не критикуй

### Пример

> **Language tip:** "I want agent to review my request" → "I want the agent to review my requests" (missing article "the", plural "requests")

### Когда пропускать

- Сообщение уже грамотное и ясное
- Пользователь отправляет код, логи или технический вывод
